# logicanalyser

## Overview
This project contains the source code of the STM32MP157 Cortex-M4 firmware for the [**logic analyzer example**](https://wiki.st.com/stm32mpu/wiki/How_to_exchange_data_buffers_with_the_coprocessor).

The logic analyzer example can be executed on the **STM32MP135C/F-DK Discovery kit** boards.

This project is linked with the [**meta-st-stm32mpu-app-logicanalyser** meta layer](https://github.com/STMicroelectronics/meta-st-stm32mpu-app-logicanalyser) that is the application for the logic analyzer example (based on GTK for the user interface). In particular, the STM32P157 Cortex-M4 firmware (how2elbd04140.elf), generated thanks to this project, is copied in the meta layer.

This version is based on the [**STM32MP1-ecosystem-v4.0.0 ecosystem release**](https://wiki.st.com/stm32mpu/wiki/STM32_MPU_ecosystem_release_note_-_v4.0.0) of the STM32MPU Embedded Software distribution which means:
- STM32CubeMX v6.6.0
- STM23CubeIDE v1.10.0
- STM32CubeMP1 v1.6.0

## Table of Contents
1. Documentation
2. How to build the firmware for the logic analyzer example?
3. How to use the demo?
4. Limitations - issues

## 1. Documentation
- ["How to exchange data buffers with the coprocessor" wiki article](https://wiki.st.com/stm32mpu/wiki/How_to_exchange_data_buffers_with_the_coprocessor)
- [STM32MP157x-DKx Discovery kit schematics](https://wiki.st.com/stm32mpu/wiki/STM32MP15_resources#MB1272_schematics) through the STM32MP15 resources wiki article
- [STM32MP157x-DKx Discovery kit hardware description wiki article](https://wiki.st.com/stm32mpu/wiki/STM32MP157x-DKx_-_hardware_description)

## 2. How to build the firmware for the logic analyzer example?
- Install the versions of the STM32CubeMX and STM32CubeIDE tools listed in the overview
- Go to the STM32CubeIDE workspace
```
PC $> cd <your STM32CubeIDE workspace>
```
- Add the logicanalyser project (**kirkstone** branch):
```
PC $> git clone https://github.com/STMicroelectronics/logicanalyser.git -b kirkstone
```
- Use the STM32CubeMX and STM32CubeIDE tools to modify (if needed) and rebuild the Cortex-M4 firmware. Note the following files:
  - LA_M4_FW.ioc: STM32CubeMX project
  - CM4/.cproject: STM32CubeIDE project
  - CM4/Debug/how2elbd04140.elf: firmware

The source code contains all the files needed to build the firmware: there is no dependency on any other package or repository.

The source code added on top of the code generated by STM32CubeMX is in user sections.

Once built, the Cortex-M4 firmware shall be copied in the [meta-st-stm32mpu-app-logicanalyser meta layer](https://github.com/STMicroelectronics/meta-st-stm32mpu-app-logicanalyser).

## 3. How to use the example?
See explanations in the [meta-st-stm32mpu-app-logicanalyser meta layer](https://github.com/STMicroelectronics/meta-st-stm32mpu-app-logicanalyser).

## 4. Limitations - issues
- STM32CubeMX: problem with the the OpenSTLinux "DeviceTree Root Location" setting<br />
  The absolute path to the OpenSTLinux "DeviceTree Root Location" is hard-coded in the Project Manager. Consequently, to modify this path, please edit the "LA_M4_FW.ioc" file and set the "ProjectManager.DeviceTreeLocation" setting with your own path.
